<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Planner Portal - RMB</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  html, body {
    margin: 0;
    height: 100%;
    font-family: Arial, sans-serif;
    background: url('https://github.com/RMB-DMAC-JAKE-001/locator-site/blob/main/planner%20rmb_page-0001.jpg?raw=true') no-repeat center center;
    background-size: contain;
    background-color: black;
    color: white;
    font-weight: bold;
  }
  .container {
    background-color: rgba(0,0,0,0.6);
    max-width: 500px;
    margin: 30px auto;
    padding: 20px 30px;
    border-radius: 10px;
    text-align: center;
  }
  h1 { margin-bottom: 20px; }
  input, button {
    width: 100%;
    padding: 12px;
    margin: 10px 0;
    font-size: 16px;
    border-radius: 5px;
    border: 1px solid white;
    background: transparent;
    color: white;
    font-weight: bold;
  }
  input::placeholder { color: #ffffffcc; }
  button { background-color: #007BFF; border: none; cursor: pointer; }
  button:hover { background-color: #0056b3; }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    color: white;
  }
  th, td {
    border: 1px solid white;
    padding: 8px;
    text-align: center;
  }
  th { background-color: rgba(0,0,0,0.7); }
  td a { color: #00f; font-weight: bold; text-decoration: none; }
  td button {
    background-color: #28a745;
    padding: 5px 10px;
    font-size: 14px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    margin-top: 2px;
  }
  td button:hover { background-color: #1e7e34; }
  #loginDiv { height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px; }
  #loginDiv input { max-width: 300px; }
  #loginError { color:red; margin-top:10px; }
</style>
</head>
<body>

<div id="loginDiv" class="container">
  <h1>Planner Login</h1>
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <p id="loginError"></p>
</div>

<div id="portalDiv" style="display:none;" class="container">
  <img src="https://github.com/RMB-DMAC-JAKE-001/locator-site/blob/main/RMB%20X%20DAMAC.png?raw=true" style="width:120px; margin-bottom:10px;">
  <h1>Planner Portal</h1>
  <input type="text" id="orderNumber" placeholder="Order Number">
  <input type="text" id="customerName" placeholder="Customer Name">
  <input type="text" id="token" placeholder="Token">
  <input type="text" id="trucks" placeholder="Trucks Involved">
  <button type="button" onclick="addOrder()">Add Order</button>

  <div id="summary">
    <h2 style="margin-top:30px;">Orders Summary</h2>
    <table id="ordersTable">
      <thead>
        <tr>
          <th>Order Number</th>
          <th>Customer Name</th>
          <th>Token</th>
          <th>Trucks</th>
          <th>Customer Link</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
// Login credentials
const correctUser = "damac";
const correctPass = "12345";

// Orders array
let orders = [];

// Load saved orders from localStorage
if (localStorage.getItem('plannerOrders')) {
  orders = JSON.parse(localStorage.getItem('plannerOrders'));
}

// Login function
function login() {
  const user = document.getElementById('username').value.trim();
  const pass = document.getElementById('password').value.trim();
  if(user === correctUser && pass === correctPass) {
    document.getElementById('loginDiv').style.display = "none";
    document.getElementById('portalDiv').style.display = "block";
    renderTable();
  } else {
    document.getElementById('loginError').innerText = "Invalid username or password!";
  }
}

// Add new order
function addOrder() {
  const order = document.getElementById('orderNumber').value.trim();
  const customer = document.getElementById('customerName').value.trim();
  const token = document.getElementById('token').value.trim();
  const trucks = document.getElementById('trucks').value.trim();

  if (!order || !customer || !token || !trucks) {
    alert("Please fill in all fields.");
    return;
  }

  const customerLink = `https://rmb-dmac-jake-001.github.io/locator-site/?t=${encodeURIComponent(token)}`;
  const newOrder = { order, customer, token, trucks, customerLink };
  orders.push(newOrder);

  localStorage.setItem('plannerOrders', JSON.stringify(orders));

  renderTable();

  // Clear inputs
  document.getElementById('orderNumber').value = '';
  document.getElementById('customerName').value = '';
  document.getElementById('token').value = '';
  document.getElementById('trucks').value = '';
}

// Render summary table
function renderTable() {
  const tbody = document.querySelector("#ordersTable tbody");
  tbody.innerHTML = '';
  orders.forEach((o, index) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${o.order}</td>
      <td>${o.customer}</td>
      <td>${o.token}</td>
      <td>${o.trucks}</td>
      <td>
        <a href="${o.customerLink}" target="_blank">${o.customerLink}</a><br>
        <button onclick="copyLink('${o.customerLink}')">Copy</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

// Copy link
function copyLink(link) {
  navigator.clipboard.writeText(link).then(() => {
    alert("Customer link copied!");
  }).catch(err => {
    alert("Failed to copy: " + err);
  });
}
</script>

</body>
</html>
